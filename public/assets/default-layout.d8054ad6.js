var Fe=Object.defineProperty,Te=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var ee=(r,o,n)=>o in r?Fe(r,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[o]=n,j=(r,o)=>{for(var n in o||(o={}))oe.call(o,n)&&ee(r,n,o[n]);if(P)for(var n of P(o))re.call(o,n)&&ee(r,n,o[n]);return r},ae=(r,o)=>Te(r,De(o));var ne=(r,o)=>{var n={};for(var i in r)oe.call(r,i)&&o.indexOf(i)<0&&(n[i]=r[i]);if(r!=null&&P)for(var i of P(r))o.indexOf(i)<0&&re.call(r,i)&&(n[i]=r[i]);return n};import{a as V,c as le,_ as R,u as ue,b as A,e as Ee,f as Ie,h as Re,i as se,l as de,j as me}from"./index.51a1eb25.js";import{F as Ae}from"./index.7f302dbc.js";import{aV as Ne,d as I,C as p,aE as k,aH as a,D as E,aJ as Q,F as G,aF as D,G as v,aI as t,aO as F,aN as M,aK as X,bn as je,b8 as pe,bN as Pe,bu as Oe,bO as Ue,bP as Ve,bQ as Ke,e as T,r as We,t as qe,c as w,u as g,bd as He,bB as Je,aW as ge,bC as Ye,bE as Ge,i as Qe,aL as B,bD as Xe,aU as Ze,bR as eo,bS as oo,bT as ro,bF as ao,bU as no,bk as to,bV as co,bW as io,bX as lo,h as O,bY as U,bZ as uo,b_ as so,w as he,E as be,b$ as mo,ba as po,bb as go,c0 as ho,o as bo,c1 as vo,c2 as fo,c3 as te,c4 as xo,c5 as _o,p as ko,bf as yo,c6 as wo,c7 as zo,aY as Co,c8 as $o,c9 as Lo}from"./arco.f15df757.js";import{f as K,i as So,j as Mo,k as Bo,h as ve,l as Fo}from"./vue.b7a8a9c1.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{u as To}from"./loading.c87df9c1.js";/* empty css              *//* empty css              */import{s as ce,c as J,a as Y}from"./customernum.1eea9bff.js";import"./chart.3ce5fa7c.js";function Do(){const r=K(),o=V();return{logout:async i=>{await o.logout();const d=r.currentRoute.value;Ne.success("\u767B\u51FA\u6210\u529F"),r.push({name:i&&typeof i=="string"?i:"login",query:ae(j({},r.currentRoute.value.query),{redirect:d.name})})}}}function Eo(){return le.get("/api/message/unreadlist")}function Io(r){return le.post("/api/message/read",r)}const Ro=M("\u672A\u5F00\u59CB"),Ao=M("\u5DF2\u5F00\u901A"),No=M("\u8FDB\u884C\u4E2D"),jo=M("\u5373\u5C06\u5230\u671F"),Po=["onClick"],Oo=I({__name:"list",props:{renderList:{type:Array,required:!0},unreadCount:{type:Number,default:0}},emits:["itemClick"],setup(r,{emit:o}){const n=i=>{i.status||o("itemClick",[i])};return(i,d)=>{const u=je,f=pe,s=Pe,C=Oe,l=Ue,y=Ve,z=Ke;return p(),k(z,{bordered:!1},{default:a(()=>[(p(!0),E(X,null,Q(r.renderList,c=>(p(),k(y,{key:c.id,"action-layout":"vertical",style:G({opacity:c.status?.5:1})},{extra:a(()=>[c.messageType===0?(p(),k(u,{key:0,color:"gray"},{default:a(()=>[Ro]),_:1})):c.messageType===1?(p(),k(u,{key:1,color:"green"},{default:a(()=>[Ao]),_:1})):c.messageType===2?(p(),k(u,{key:2,color:"blue"},{default:a(()=>[No]),_:1})):c.messageType===3?(p(),k(u,{key:3,color:"red"},{default:a(()=>[jo]),_:1})):D("",!0)]),default:a(()=>[v("div",{class:"item-wrap",onClick:h=>n(c)},[t(l,null,{title:a(()=>[t(f,{size:4},{default:a(()=>[v("span",null,F(c.title),1)]),_:2},1024)]),description:a(()=>[v("div",null,[t(s,{ellipsis:{rows:1}},{default:a(()=>[M(F(c.content),1)]),_:2},1024),t(C,{class:"time-text"},{default:a(()=>[M(F(c.time),1)]),_:2},1024)])]),_:2},1024)],8,Po)]),_:2},1032,["style"]))),128))]),_:1})}}});var Uo=R(Oo,[["__scopeId","data-v-4c1c48bc"]]);const Vo=M(" \u5168\u90E8\u5DF2\u8BFB "),Ko=M(" \u67E5\u770B\u66F4\u591A "),Wo=I({__name:"index",setup(r){const o=V(),{loading:n,setLoading:i}=To(!0),d=T("notice");ue();const u=We({renderList:[],messageList:[]});qe(u);const f=[{key:"notice",title:"\u5F85\u529E\u65E5\u7A0B"}];async function s(){i(!0);try{const{data:e}=await Eo();o.noticeCount=e.length,u.messageList=e}catch{}finally{i(!1)}}async function C(e){const m=e.map(b=>b.id);await Io({ids:m}),s()}const l=w(()=>u.messageList.filter(e=>d.value===e.type)),y=w(()=>l.value.filter(e=>!e.status).length),z=e=>u.messageList.filter(b=>b.type===e&&!b.status),c=e=>{const m=z(e);return m.length?`(${m.length})`:""},h=e=>{l.value.length&&C([...e])},x=()=>{C(u.messageList)};return s(),(e,m)=>{const b=He,_=Je,L=ge,$=Ye,N=Ge;return p(),k(N,{style:{display:"block"},loading:g(n)},{default:a(()=>[t($,{activeKey:d.value,"onUpdate:activeKey":m[1]||(m[1]=S=>d.value=S),type:"rounded","destroy-on-hide":""},{extra:a(()=>[t(L,{type:"text",onClick:x},{default:a(()=>[Vo]),_:1}),t(L,{type:"text",onClick:m[0]||(m[0]=S=>e.$router.push({name:"NoticeList"}))},{default:a(()=>[Ko]),_:1})]),default:a(()=>[(p(),E(X,null,Q(f,S=>t(_,{key:S.key},{title:a(()=>[v("span",null,F(S.title)+F(c(S.key)),1)]),default:a(()=>[g(l).length?D("",!0):(p(),k(b,{key:0,status:"404"},{subtitle:a(()=>[M(F(e.$t("messageBox.noContent")),1)]),_:1})),t(Uo,{"render-list":g(l),"unread-count":g(y),onItemClick:h},null,8,["render-list","unread-count"])]),_:2},1024)),64))]),_:1},8,["activeKey"])]),_:1},8,["loading"])}}});var qo=R(Wo,[["__scopeId","data-v-e30bbb98"]]);const Ho={class:"navbar"},Jo={class:"left-side"},Yo=M(" CRM\u7BA1\u7406\u7CFB\u7EDF "),Go={class:"right-side"},Qo=M(" \u5728\u7EBF "),Xo=M(" \u79BB\u7EBF "),Zo={class:"message-box-trigger"},er=["src"],or={style:{"text-align":"center"}},rr=I({__name:"index",setup(r){const o=A(),n=V(),{logout:i}=Do();Ee();const{isFullscreen:d,toggle:u}=So(),f=w(()=>n.avatar),s=T(n.online),C=w(()=>n.noticeCount),l=w(()=>o.theme),y=Mo({selector:"body",attribute:"arco-theme",valueDark:"dark",valueLight:"light",storageKey:"arco-theme",onChanged(_){o.toggleTheme(_)}}),z=Bo(y),c=()=>{z()},h=T();T();const x=()=>{const _=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});h.value.dispatchEvent(_)},e=()=>{i()},m=async()=>{await n.switchOnlineProxy(s.value)},b=Qe("toggleDrawerMenu");return(_,L)=>{const $=Xe,N=B("icon-menu-fold"),S=pe,fe=Ze,xe=B("icon-notification"),W=ge,_e=eo,q=oo,ke=ro,ye=B("icon-moon-fill"),we=B("icon-sun-fill"),ze=B("icon-fullscreen-exit"),Ce=B("icon-fullscreen"),$e=ao,H=no,Le=to,Se=B("icon-settings"),Me=B("icon-export"),Be=co;return p(),E("div",Ho,[v("div",Jo,[t(S,null,{default:a(()=>[t($,{style:{margin:0,fontSize:"18px"},heading:5},{default:a(()=>[Yo]),_:1}),g(o).device==="mobile"?(p(),k(N,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:g(b)},null,8,["onClick"])):D("",!0)]),_:1})]),v("ul",Go,[v("li",null,[t(fe,{modelValue:s.value,"onUpdate:modelValue":L[0]||(L[0]=Z=>s.value=Z),onChange:m},{checked:a(()=>[Qo]),unchecked:a(()=>[Xo]),_:1},8,["modelValue"])]),v("li",null,[t(q,{content:_.$t("settings.navbar.alerts")},{default:a(()=>[v("div",Zo,[t(_e,{count:g(C)},{default:a(()=>[t(W,{class:"nav-btn",type:"outline",shape:"circle",onClick:x},{default:a(()=>[t(xe)]),_:1})]),_:1},8,["count"])])]),_:1},8,["content"]),t(ke,{trigger:"click","arrow-style":{display:"none"},"content-style":{padding:0,minWidth:"440px"},"content-class":"message-popover"},{content:a(()=>[t(qo)]),default:a(()=>[v("div",{ref_key:"refBtn",ref:h,class:"ref-btn"},null,512)]),_:1})]),v("li",null,[t(q,{content:g(l)==="light"?_.$t("settings.navbar.theme.toDark"):_.$t("settings.navbar.theme.toLight")},{default:a(()=>[t(W,{class:"nav-btn",type:"outline",shape:"circle",onClick:c},{icon:a(()=>[g(l)==="dark"?(p(),k(ye,{key:0})):(p(),k(we,{key:1}))]),_:1})]),_:1},8,["content"])]),v("li",null,[t(q,{content:g(d)?_.$t("settings.navbar.screen.toExit"):_.$t("settings.navbar.screen.toFull")},{default:a(()=>[t(W,{class:"nav-btn",type:"outline",shape:"circle",onClick:g(u)},{icon:a(()=>[g(d)?(p(),k(ze,{key:0})):(p(),k(Ce,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"])]),v("li",null,[t(Be,{trigger:"click"},{content:a(()=>[t(H,null,{default:a(()=>[v("div",or," \u4F60\u597D, "+F(g(n).name)+"\uFF01 ",1)]),_:1}),t(Le,{style:{margin:"4px 0px"}}),t(H,null,{default:a(()=>[t(S,{onClick:L[1]||(L[1]=Z=>_.$router.push({name:"Usersetting"}))},{default:a(()=>[t(Se),v("span",null,F(_.$t("messageBox.userSettings")),1)]),_:1})]),_:1}),t(H,null,{default:a(()=>[t(S,{onClick:e},{default:a(()=>[t(Me),v("span",null,F(_.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:a(()=>[t($e,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:a(()=>[v("img",{alt:"avatar",src:g(f)},null,8,er)]),_:1})]),_:1})])])])}}});var ar=R(rr,[["__scopeId","data-v-e4be037c"]]);const nr=(r,o)=>{const d=o||{},{target:n="_blank"}=d,i=ne(d,["target"]);window.open(r,n,Object.entries(i).reduce((u,f)=>{const[s,C]=f;return[...u,`${s}=${C}`]},[]).join(","))},tr=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),cr=[...Ie,...Re],ir=cr.map(r=>{const{name:o,path:n,meta:i,redirect:d,children:u}=r;return{name:o,path:n,meta:i,redirect:d,children:u}});function lr(){const r=se(),o=A(),n=w(()=>o.menuFromServer?o.appAsyncMenus:ir);return{menuTree:w(()=>{const d=JSON.parse(JSON.stringify(n.value));d.sort((f,s)=>(f.meta.order||0)-(s.meta.order||0));function u(f,s){return f?f.map(l=>{var z,c;if(!r.accessRouter(l))return null;if(((z=l.meta)==null?void 0:z.hideChildrenInMenu)||!l.children)return l.children=[],l;l.children=l.children.filter(h=>{var x;return((x=h.meta)==null?void 0:x.hideInMenu)!==!0});const y=u(l.children,s+1);return y.length||s>1?(l.children=y,l):((c=l.meta)==null?void 0:c.hideInMenu)===!1?l:null}).filter(Boolean):null}return u(d,0)})}}function ur(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!io(r)}var sr=I({emit:["collapse"],setup(){const{t:r}=ue(),o=A(),n=K(),i=ve(),{menuTree:d}=lr(),u=w({get(){return o.device==="desktop"?o.menuCollapse:!1},set(c){o.updateSettings({menuCollapse:c})}}),f=T([]),s=T([]);ce(),setInterval(function(){ce()},1e4);const C=c=>{if(tr.test(c.path)){nr(c.path),s.value=[c.name];return}const{hideInMenu:h,activeMenu:x}=c.meta;if(i.name===c.name&&!h&&!x){s.value=[c.name];return}n.push({name:c.name})},l=c=>{const h=[];let x=!1;const e=(m,b,_)=>{var L;if(m.name===_){x=!0,h.push(...b,m.name);return}(L=m.children)!=null&&L.length&&m.children.forEach($=>{e($,[...b],_)})};return d.value.forEach(m=>{x||e(m,[m.name],c)}),h};de(c=>{const{requiresAuth:h,activeMenu:x,hideInMenu:e}=c.meta;if(!e||x){const m=l(x||c.name),b=new Set([...m,...f.value]);f.value=[...b],s.value=[x||m[m.length-1]]}},!0);const y=c=>{o.device==="desktop"&&o.updateSettings({menuCollapse:c})},z=()=>{function c(h,x=[]){return h&&h.forEach(e=>{var L;const m=(L=e==null?void 0:e.meta)!=null&&L.icon?()=>{var $;return O(U(`<${($=e==null?void 0:e.meta)==null?void 0:$.icon}/>`))}:null,b=T();(e==null?void 0:e.name)==="CustomerNewList"&&J.value>0?b.value=O(U(`<span style="padding: 0px; font-size: 12px; line-height: 20px; height: 20px; background: red; border-radius: 10px; color: #fff; margin-left: 10px; min-width: 20px; display: inline-block; text-align: center; font-weight: bold;">${J.value>99?"99+":J.value}</span>`)):(e==null?void 0:e.name)==="ApproveOther"&&Y.value>0?b.value=O(U(`<span style="padding: 0px; font-size: 12px; line-height: 20px; height: 20px; background: red; border-radius: 10px; color: #fff; margin-left: 10px; min-width: 20px; display: inline-block; text-align: center; font-weight: bold;">${Y.value>99?"99+":Y.value}</span>`)):b.value=null;const _=(e==null?void 0:e.children)&&(e==null?void 0:e.children.length)!==0?t(uo,{key:e==null?void 0:e.name},{default:()=>[c(e==null?void 0:e.children)],icon:m,title:()=>{var $;return O(U(r((($=e==null?void 0:e.meta)==null?void 0:$.locale)||"")))}}):t(so,{key:e==null?void 0:e.name,onClick:()=>C(e)},{default:()=>{var $;return[r((($=e==null?void 0:e.meta)==null?void 0:$.locale)||""),b.value]},icon:m});x.push(_)}),x}return c(d.value)};return()=>{let c;return t(lo,{collapsed:u.value,"onUpdate:collapsed":h=>u.value=h,theme:"dark","show-collapse-button":o.device!=="mobile","auto-open":!0,"selected-keys":s.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%",onCollapse:y},ur(c=z())?c:{default:()=>[c]})}}});var ie=R(sr,[["__scopeId","data-v-bcd22dce"]]);const dr=r=>(po("data-v-4e2b11ca"),r=r(),go(),r),mr={class:"tab-bar-container"},pr={class:"tab-bar-box"},gr={class:"tab-bar-scroll"},hr={class:"tags-wrap"},br=["onClick"],vr={class:"tag-link"},fr=["onClick"],xr=dr(()=>v("div",{class:"tag-bar-operation"},null,-1)),_r=I({__name:"index",setup(r){const o=A(),n=me(),i=K(),d=T(),u=w(()=>n.getTabList),f=w(()=>o.navbar?60:0);he(()=>o.navbar,()=>{d.value.updatePosition()}),de(l=>{!l.meta.noAffix&&!u.value.some(y=>y.fullPath===l.fullPath)&&n.updateTabList(l)},!0);const s=(l,y)=>{if(n.deleteTag(y,l),y===u.value.length){const z=u.value[u.value.length-1];i.push({name:z.name})}},C=l=>{i.push(j({},l))};return(l,y)=>{const z=B("icon-close"),c=ho;return p(),E("div",mr,[t(c,{ref_key:"affixRef",ref:d,"offset-top":g(f)},{default:a(()=>[v("div",pr,[v("div",gr,[v("div",hr,[(p(!0),E(X,null,Q(g(u),(h,x)=>(p(),E("span",{key:h.fullPath,class:be(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":h.fullPath===l.$route.fullPath}]),onClick:e=>C(h)},[v("span",vr,F(l.$t(h.title)),1),v("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:mo(e=>s(h,x),["stop"])},[t(z)],8,fr)],10,br))),128))])]),xr])]),_:1},8,["offset-top"])])}}});var kr=R(_r,[["__scopeId","data-v-4e2b11ca"]]);function yr(r,o,n,i=!1){r.addEventListener&&typeof r.addEventListener=="function"&&r.addEventListener(o,n,i)}function wr(r,o,n,i=!1){r.removeEventListener&&typeof r.removeEventListener=="function"&&r.removeEventListener(o,n,i)}const zr=992;function Cr(){return document.body.getBoundingClientRect().width-1<zr}function $r(r){const o=A();function n(){if(!document.hidden){const d=Cr();o.toggleDevice(d?"mobile":"desktop"),o.toggleMenu(d)}}const i=Fo(n,100);bo(()=>{r&&i()}),vo(()=>{yr(window,"resize",i)}),fo(()=>{wr(window,"resize",i)})}const Lr=I({__name:"page-layout",setup(r){const o=me(),n=w(()=>o.getCacheList);return(i,d)=>{const u=B("router-view");return p(),k(u,null,{default:a(({Component:f,route:s})=>[t(_o,{name:"fade",mode:"out-in",appear:""},{default:a(()=>[s.meta.ignoreCache?(p(),k(te(f),{key:s.fullPath})):(p(),k(xo,{key:1,include:g(n)},[(p(),k(te(f),{key:s.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}});const Sr={key:0,class:"layout-navbar"},Mr={class:"menu-wrapper"},Br=I({__name:"default-layout",setup(r){const o=A(),n=V(),i=K(),d=ve(),u=se();$r(!0);const f="60px",s=w(()=>o.navbar),C=w(()=>o.menu),l=w(()=>o.hideMenu),y=w(()=>o.footer),z=w(()=>o.menuCollapse?48:o.menuWidth),c=w(()=>o.menuCollapse),h=w(()=>{const b=C.value&&!l.value?{paddingLeft:`${z.value}px`}:{},_=s.value?{paddingTop:f}:{};return j(j({},b),_)}),x=b=>{o.updateSettings({menuCollapse:b})};he(()=>n.role,b=>{b&&!u.accessRouter(d)&&i.push({name:"notFound"})});const e=T(!1),m=()=>{e.value=!1};return ko("toggleDrawerMenu",()=>{e.value=!e.value}),(b,_)=>{const L=zo,$=Co,N=$o,S=Lo;return p(),k(S,{class:be(["layout",{mobile:g(o).hideMenu}])},{default:a(()=>[g(s)?(p(),E("div",Sr,[t(ar)])):D("",!0),t(S,null,{default:a(()=>[t(S,null,{default:a(()=>[g(C)?yo((p(),k(L,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:g(c),collapsible:!0,width:g(z),style:G({paddingTop:g(s)?"60px":""}),"hide-trigger":!0,onCollapse:x},{default:a(()=>[v("div",Mr,[t(ie)])]),_:1},8,["collapsed","width","style"])),[[wo,!g(l)]]):D("",!0),g(l)?(p(),k($,{key:1,visible:e.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:m},{default:a(()=>[t(ie)]),_:1},8,["visible"])):D("",!0),t(S,{class:"layout-content",style:G(g(h))},{default:a(()=>[g(o).tabBar?(p(),k(kr,{key:0})):D("",!0),t(N,null,{default:a(()=>[t(Lr)]),_:1}),g(y)?(p(),k(Ae,{key:1})):D("",!0)]),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["class"])}}});var Gr=R(Br,[["__scopeId","data-v-56ba01a2"]]);export{Gr as default};
